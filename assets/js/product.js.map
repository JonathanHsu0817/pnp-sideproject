{"version":3,"sources":["product.js"],"names":["BASE_URL","USERS_URL","PRODUCTS_URL","id","productsItemsContent","document","querySelector","swiperProduct","addEventListener","getTargetproductId","e","targetID","target","closest","dataset","localStorage","setItem","getLoggedID","getItem","getTableID","getProductID","templateOfProductsItem","products","template","img","category","title","description","main","price","quantity","inputNum","nodeName","getAttribute","value","userId","productId","tableId","data","Number","url","axios","post","then","response","status","renderCartState","sweetSmallSuccess","error","console","log","JSON","stringify","clear","window","location","replace","renderProductsPage","get","productsItemData","innerHTML","alert","init"],"mappings":"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","sourcesContent":["const BASE_URL = 'http://localhost:3000';\r\n// const BASE_URL = 'https://sideproject-pnp-json-server-vercel.vercel.app/';\r\nconst USERS_URL = `${BASE_URL}/600/users`;\r\nconst PRODUCTS_URL = `${BASE_URL}/products`;\r\nlet id = 1;\r\n\r\nconst productsItemsContent = document.querySelector(\".productsContent\");\r\nconst swiperProduct = document.querySelector('.js-swiper-product')\r\n\r\nswiperProduct.addEventListener('click',getTargetproductId)\r\n\r\nfunction getTargetproductId(e){\r\n  // e.preventDefault();\r\n  const targetID = e.target.closest(\"A\").dataset.id;\r\n  localStorage.setItem('productId', targetID) || 0;\r\n}\r\n\r\nfunction getLoggedID() {\r\n    return localStorage.getItem('userId') || 0;\r\n  }\r\n  \r\nfunction getTableID() {\r\n    return localStorage.getItem('tableId') || 0;\r\n  }\r\n\r\nfunction getProductID() {\r\n    return localStorage.getItem('productId') || 0;\r\n  }\r\n\r\n\r\nfunction templateOfProductsItem(products, template = ``) {\r\n    // console.log('products:::', JSON.stringify(products, null, 2));\r\n        template += `\r\n        <div class=\"col-md-6 pe-md-0\">\r\n            <div class=\"overflow-hidden\">\r\n                <img src=\"${products.img}\" class=\"img-fluid \" alt=\"food.png\">\r\n            </div>\r\n        </div>\r\n        <div class=\"col-md-6\">\r\n            <div class=\"description d-flex flex-column h-100 text-primary p-3 px-md-0 pt-0 pb-3 pb-md-0\" >\r\n                <span class=\"text-secondary mt-3\">${products.category}</span>\r\n                <h2 class=\"description-title text-primary mb-5\">${products.title}</h2>\r\n                <p class=\"description-content text-black mb-5\">${products.description}</p>\r\n                <h3 class=\"fs-8 text-black mb-auto\"><i class=\"fas fa-genderless\"></i> 主食材：${products.main}</h3>\r\n                <p class=\"mb-3\">價錢：NT $${products.price}</p>\r\n\r\n                <div class=\"input-group\">\r\n                    <button class=\"btn btn-outline-primary btn-text-primary \" type=\"button\" id=\"button-minus\">-</button>\r\n                    <input type=\"number\" class=\"form-num text-center border-1 border-primary bg-backStage text-primary flex-fill\" value=\"${products.quantity}\">\r\n                    <button class=\"btn btn-outline-primary btn-text-primary\" type=\"button\" id=\"button-plus\">+</button>\r\n                </div>\r\n                <a href=\"#\" class=\"js-addCartBtn btn btn-outline-primary btn-text-primary -mt-xs-1\">加入購物車</a>\r\n            </div>\r\n        </div>\r\n        `;\r\n    \r\n    /* end of products.forEach() */\r\n    return template;\r\n  }\r\n\r\n\r\n//數字加減操作&加入購物車\r\nproductsItemsContent.addEventListener(\"click\",(e)=>{\r\n    const inputNum = document.querySelector(\".form-num\")\r\n    if(e.target.nodeName==\"BUTTON\"){\r\n        if(e.target.getAttribute(\"id\")==\"button-minus\"&&inputNum.value>1){\r\n            inputNum.value--;\r\n        }else if(e.target.getAttribute(\"id\")==\"button-plus\"){\r\n            inputNum.value++;\r\n        }\r\n    }\r\n\r\n    if(e.target.getAttribute(\"class\")!==\"js-addCartBtn btn btn-outline-primary btn-text-primary -mt-xs-1\"){\r\n        return\r\n    }\r\n    let userId = getLoggedID();\r\n    let productId = getProductID();\r\n    let tableId = getTableID();\r\n\r\n    const data = {\r\n        userId: userId,\r\n        productId: productId,\r\n        tableId: tableId,\r\n        quantity: Number(inputNum.value)\r\n      }\r\n    // console.log(data);\r\n    const url = `${USERS_URL}/${userId}/carts`;\r\n  \r\n    axios.post(url, data)\r\n    .then(function (response) {\r\n        // console.log('carts:::', JSON.stringify(response, null, 2))\r\n    if (response.status === 201) {\r\n        renderCartState();\r\n        sweetSmallSuccess(\"成功加入購物車~~\")\r\n        }\r\n    })\r\n    .catch(function (error) {\r\n        console.log('error:::', JSON.stringify(error, null, 2));\r\n\r\n    if (error?.response?.status === 401) {\r\n        console.log('401');\r\n        localStorage.clear();\r\n        window.location.replace('/login.html');\r\n        }\r\n    });\r\n})\r\n \r\nfunction renderProductsPage() {\r\n    const productId = getProductID();\r\n\r\n    const url = `${PRODUCTS_URL}/${productId}`;\r\n\r\n    axios\r\n      .get(url)\r\n      .then(function (response) {\r\n        // console.log('GET-Products:::', JSON.stringify(response, null, 2));\r\n\r\n        if (response.status === 200) {\r\n          const productsItemData = response.data;\r\n        //   console.log(productsItemData);\r\n          productsItemsContent.innerHTML = templateOfProductsItem(productsItemData);\r\n        }\r\n      })\r\n\r\n      .catch(function (error) {\r\n        // console.log('error:::', JSON.stringify(error, null, 2));\r\n       alert(error?.response?.status || error); \r\n      });\r\n\r\n    /*  end of axios */\r\n  }\r\n\r\n  function init(){\r\n    renderProductsPage();\r\n  }\r\n  \r\n  init();"],"file":"product.js"}
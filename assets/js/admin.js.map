{"version":3,"sources":["admin.js"],"names":["BASE_URL","USERS_URL","ORDERS_URL","orderContent","document","querySelector","addEventListener","e","target","nodeName","targetInput","closest","getAttribute","setAttribute","parentNode","classList","add","removeAttribute","remove","orderId","dataset","id","AUTH","localStorage","getItem","axios","defaults","headers","common","Authorization","url","data","hasAllDelivered","patch","then","res","console","log","sweetSuccess","getOrderData","renderTotalState","err","sweetError","renderCartList","str","forEach","item","createdAt","products","table","list","productItem","listItem","deliverStatus","title","quantity","content","area","switchTimeStamp","innerHTML","get","orderData","orderDataFiltered","filter","init","timeStamp","thisStamp","Date","minutes","getMinutes","thisTime","getFullYear","getMonth","getDate","getHours","Sortable","ghostClass","animation"],"mappings":";;AAAA;AACA,IAAMA,QAAQ,GAAG,uDAAjB;AACA,IAAMC,SAAS,aAAMD,QAAN,eAAf;AACA,IAAME,UAAU,aAAMF,QAAN,8BAAhB;AAEA,IAAMG,YAAY,GAAGC,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAArB;AAEAF,YAAY,CAACG,gBAAb,CAA8B,OAA9B,EAAsC,UAACC,CAAD,EAAK;AACvC;AACA,MAAGA,CAAC,CAACC,MAAF,CAASC,QAAT,KAAoB,OAAvB,EAA+B;AAC3B,QAAIC,WAAW,GAAGH,CAAC,CAACC,MAAF,CAASG,OAAT,CAAiB,OAAjB,CAAlB;;AACA,QAAGD,WAAW,CAACE,YAAZ,CAAyB,CAAC,eAAD,CAAzB,KAA6C,IAAhD,EAAqD;AACjDF,MAAAA,WAAW,CAACG,YAAZ,CAAyB,CAAC,eAAD,CAAzB,EAA2C,SAA3C;AACAH,MAAAA,WAAW,CAACI,UAAZ,CAAuBA,UAAvB,CAAkCC,SAAlC,CAA4CC,GAA5C,CAAgD,eAAhD;AACA;AACH,KAJD,MAIK;AACDN,MAAAA,WAAW,CAACO,eAAZ,CAA4B,CAAC,eAAD,CAA5B;AACAP,MAAAA,WAAW,CAACI,UAAZ,CAAuBA,UAAvB,CAAkCC,SAAlC,CAA4CG,MAA5C,CAAmD,eAAnD;AACA;AACH;AAEJ,GAZD,MAYM,IAAGX,CAAC,CAACC,MAAF,CAASC,QAAT,KAAoB,QAAvB,EAAgC;AAClC;AACA,QAAIU,OAAO,GAAGZ,CAAC,CAACC,MAAF,CAASY,OAAT,CAAiBC,EAA/B;AAEA,QAAMC,IAAI,oBAAaC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb,CAAV;AACAC,IAAAA,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA8CP,IAA9C;AAEA,QAAMQ,GAAG,aAAM9B,QAAN,yBAA6BmB,OAA7B,CAAT;AAEA,QAAMY,IAAI,GAAG;AACTC,MAAAA,eAAe,EAAE;AADR,KAAb;AAIAP,IAAAA,KAAK,CAACQ,KAAN,CAAYH,GAAZ,EAAgBC,IAAhB,EACCG,IADD,CACM,UAAAC,GAAG,EAAE;AACPC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACAC,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACAC,MAAAA,YAAY;AACZC,MAAAA,gBAAgB;AACnB,KAND,WAOO,UAAAC,GAAG,EAAE;AACRL,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACAK,MAAAA,UAAU,CAAC,QAAD,CAAV;AACH,KAVD;AAWH,GAxBK,MAwBD;AACD;AACH;AAEJ,CA1CD;;AA4CA,SAASC,cAAT,CAAwBZ,IAAxB,EAA6B;AACzB,MAAIa,GAAG,GAAG,EAAV;AACAb,EAAAA,IAAI,CAACc,OAAL,CAAa,UAAAC,IAAI,EAAE;AACf,QAAOC,SAAP,GAAsDD,IAAtD,CAAOC,SAAP;AAAA,QAAiBC,QAAjB,GAAsDF,IAAtD,CAAiBE,QAAjB;AAAA,QAA0BhB,eAA1B,GAAsDc,IAAtD,CAA0Bd,eAA1B;AAAA,QAA0CiB,KAA1C,GAAsDH,IAAtD,CAA0CG,KAA1C;AAAA,QAAgD5B,EAAhD,GAAsDyB,IAAtD,CAAgDzB,EAAhD;AACA,QAAI6B,IAAI,GAAG,EAAX;AACAF,IAAAA,QAAQ,CAACH,OAAT,CAAiB,UAAAM,WAAW,EAAE;AAC1B,UAAIC,QAAQ,GAAG,EAAf,CAD0B,CAG1B;;AACA,UAAIC,aAAJ;AAEAD,MAAAA,QAAQ,2EAEED,WAAW,CAACG,KAFd,8DAGsBH,WAAW,CAACI,QAHlC,qJAK6DF,aAL7D,gDAAR;AAQAH,MAAAA,IAAI,IAAEE,QAAN;AACH,KAfD;AAgBA,QAAII,OAAO,6PAGoCP,KAAK,CAACQ,IAH1C,0DAIoBpC,EAJpB,qMAMqCqC,eAAe,CAACX,SAAD,CANpD,igBAeOG,IAfP,gHAAX;AAqBJN,IAAAA,GAAG,IAAEY,OAAL;AACC,GAzCD;AA0CArD,EAAAA,YAAY,CAACwD,SAAb,GAAyBf,GAAzB;AACH;;AAED,SAASL,YAAT,GAAuB;AACnB,MAAMjB,IAAI,oBAAaC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb,CAAV;AACAC,EAAAA,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA8CP,IAA9C;AAEA,MAAMQ,GAAG,aAAM5B,UAAN,CAAT;AAEAuB,EAAAA,KAAK,CAACmC,GAAN,CAAU9B,GAAV,EACCI,IADD,CACM,UAAAC,GAAG,EAAE;AACP,QAAM0B,SAAS,GAAG1B,GAAG,CAACJ,IAAtB;AACA,QAAM+B,iBAAiB,GAAED,SAAS,CAACE,MAAV,CAAiB,UAAAjB,IAAI,EAAE;AAC7C,aAAOA,IAAI,CAACd,eAAL,IAAwB,KAA/B;AACF,KAFwB,CAAzB,CAFO,CAKP;;AACAW,IAAAA,cAAc,CAACmB,iBAAD,CAAd;AACH,GARD,WASO,UAAArB,GAAG,EAAE;AACRL,IAAAA,OAAO,CAACC,GAAR,CAAYI,GAAZ;AACH,GAXD;AAYH;;AAED,SAASuB,IAAT,GAAe;AACXzB,EAAAA,YAAY;AACf;;AAEDyB,IAAI,G,CAEJ;;AAEA,SAASN,eAAT,CAAyBO,SAAzB,EAAmC;AAC/B,MAAMC,SAAS,GAAG,IAAIC,IAAJ,CAASF,SAAT,CAAlB;AACA,MAAIG,OAAO,GAAGF,SAAS,CAACG,UAAV,KAAyB,EAAzB,GAA8B,MAAMH,SAAS,CAACG,UAAV,EAApC,GAA6DH,SAAS,CAACG,UAAV,EAA3E;AACA,MAAMC,QAAQ,aAAMJ,SAAS,CAACK,WAAV,EAAN,cAAiCL,SAAS,CAACM,QAAV,KAAqB,CAAtD,cAA2DN,SAAS,CAACO,OAAV,EAA3D,cAAkFP,SAAS,CAACQ,QAAV,EAAlF,cAA0GN,OAA1G,CAAd;AACA,SAAOE,QAAP;AACH;;AAED,IAAIK,QAAJ,CAAaxE,YAAb,EAA0B;AACtByE,EAAAA,UAAU,EAAE,uBADU;AAEtBC,EAAAA,SAAS,EAAC;AAFY,CAA1B","sourcesContent":["// const BASE_URL = 'http://localhost:3000';\r\nconst BASE_URL = 'https://sideproject-pnp-json-server-vercel.vercel.app';\r\nconst USERS_URL = `${BASE_URL}/600/users`;\r\nconst ORDERS_URL = `${BASE_URL}/660/orders?_expand=table`;\r\n\r\nconst orderContent = document.querySelector(\".order-content\")\r\n\r\norderContent.addEventListener(\"click\",(e)=>{\r\n    // console.log(e.target.nodeName)\r\n    if(e.target.nodeName===\"INPUT\"){\r\n        let targetInput = e.target.closest(\"input\");\r\n        if(targetInput.getAttribute([\"deliverStatus\"])==null){\r\n            targetInput.setAttribute([\"deliverStatus\"],\"checked\");\r\n            targetInput.parentNode.parentNode.classList.add('table-success');\r\n            return\r\n        }else{\r\n            targetInput.removeAttribute([\"deliverStatus\"]);\r\n            targetInput.parentNode.parentNode.classList.remove('table-success');\r\n            return\r\n        }\r\n\r\n    }else if(e.target.nodeName===\"BUTTON\"){\r\n        //注意\r\n        let orderId = e.target.dataset.id\r\n        \r\n        const AUTH = `Bearer ${localStorage.getItem('token')}`;\r\n        axios.defaults.headers.common.Authorization = AUTH;\r\n\r\n        const url = `${BASE_URL}/660/orders/${orderId}`\r\n        \r\n        const data = {\r\n            hasAllDelivered: true\r\n        }\r\n\r\n        axios.patch(url,data)\r\n        .then(res=>{\r\n            console.log(\"已刪除\")\r\n            sweetSuccess(\"完成~\")\r\n            getOrderData()\r\n            renderTotalState();\r\n        })\r\n        .catch(err=>{\r\n            console.log(\"再確認一下\")\r\n            sweetError(\"再確認一下喔\")\r\n        })\r\n    }else{\r\n        return\r\n    }\r\n    \r\n})\r\n\r\nfunction renderCartList(data){\r\n    let str = \"\";\r\n    data.forEach(item=>{\r\n        const {createdAt,products,hasAllDelivered,table,id} = item;\r\n        let list = \"\";\r\n        products.forEach(productItem=>{\r\n            let listItem = \"\";\r\n\r\n            //判斷訂單狀態\r\n            let deliverStatus;\r\n\r\n            listItem+=`\r\n            <tr class=\"order-list\">\r\n                <td>${productItem.title}</td>\r\n                <td class=\"text-center\">${productItem.quantity}</td>\r\n                <td class=\"text-center\">\r\n                    <input data-id=\"\" type=\"checkbox\" class=\"form-check-input\" ${deliverStatus}>\r\n                </td>\r\n            </tr>`\r\n            list+=listItem\r\n        })\r\n        let content = `<div class=\"col-6 col-md-4 col-lg-3\">\r\n            <div class=\"order bg-light\">\r\n                <div class=\"d-flex justify-content-around text-center pt-4 mb-4\">\r\n                    <h2 class=\"fs-4 lh-base mb-0\">桌號：${table.area}</h2>\r\n                    <button data-id=\"${id}\" class=\"btn btn-outline-primary btn-sm\">完成訂單</button>\r\n                </div>\r\n                <div class=\"orderTime fs-8 ms-2\">訂單成立：${switchTimeStamp(createdAt)}</div>\r\n                <table class=\"table table-hover\">\r\n                    <thead>\r\n                        <tr>\r\n                            <td class=\"fw-bold\" width=\"55%\">餐點</td>\r\n                            <td class=\"fw-bold text-center\" width=\"22%\">數量</td>\r\n                            <td class=\"fw-bold text-center\" width=\"22%\">出餐</td>\r\n                        </tr>\r\n                    <tbody class=\"align-middle\">\r\n                        ${list}\r\n                    </tbody>    \r\n                </table>\r\n            </div> \r\n        </div>\r\n        `\r\n    str+=content;\r\n    })\r\n    orderContent.innerHTML = str;\r\n}\r\n\r\nfunction getOrderData(){\r\n    const AUTH = `Bearer ${localStorage.getItem('token')}`;\r\n    axios.defaults.headers.common.Authorization = AUTH;\r\n\r\n    const url = `${ORDERS_URL}`;\r\n\r\n    axios.get(url)\r\n    .then(res=>{\r\n        const orderData = res.data\r\n        const orderDataFiltered= orderData.filter(item=>{\r\n           return item.hasAllDelivered == false;\r\n        })\r\n        // console.log(orderDataFiltered)\r\n        renderCartList(orderDataFiltered);\r\n    })\r\n    .catch(err=>{\r\n        console.log(err);\r\n    })\r\n}\r\n\r\nfunction init(){\r\n    getOrderData();\r\n}\r\n\r\ninit();\r\n\r\n//utillities function\r\n\r\nfunction switchTimeStamp(timeStamp){\r\n    const thisStamp = new Date(timeStamp);\r\n    let minutes = thisStamp.getMinutes() < 10 ? '0' + thisStamp.getMinutes() : thisStamp.getMinutes();\r\n    const thisTime = `${thisStamp.getFullYear()}/${thisStamp.getMonth()+1}/${thisStamp.getDate()} ${thisStamp.getHours()}:${minutes}`\r\n    return thisTime;\r\n}\r\n\r\nnew Sortable(orderContent,{\r\n    ghostClass: 'blue-background-class',\r\n    animation:200\r\n})\r\n"],"file":"admin.js"}